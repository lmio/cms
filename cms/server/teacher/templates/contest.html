{% extends "base.html" %}
{% block title %}{{ contest.description }}{% endblock title %}

{% block core %}
<div class="span12">

<div class="page-header">
    <h1>{{ contest.description }}</h1>
</div>

<p>
  <a href="{{ url() }}">{% trans %}Back to contest list{% endtrans %}</a>
  <a style="float: right" href="{{ url("contest", contest.id, "csv") }}">{% trans %}Export to CSV{% endtrans %}</a>
</p>

<table class="table table-bordered table-striped">
  <thead>
    <tr>
      {% for head in header %}
      <th>{{ head }}</th>
      {% endfor %}
      {% if allow_contestant_leave %}
      <th style="width: 1%">{% trans %}Leave time{% endtrans %}</th>
      {% endif %}
      {% if allow_impersonate %}
      <th style="width: 1%"></th>
      {% endif %}
    </tr>
  </thead>
  <tbody>
    {% for p, row in table %}
    <tr>
      {% for item in row %}
      <td>{{ item }}</td>
      {% endfor %}
      {% if allow_contestant_leave %}
      <td style="white-space: nowrap">
        <form class="form-horizontal" style="margin: 0" enctype="multipart/form-data" action="{{ url("contestant_leave", p.id) }}" method="POST">
          {{ xsrf_form_html|safe }}
          {% if p.leave_time is none or now <= p.leave_time %}
          <button type="submit" name="state" value="left" class="btn">{% trans %}Contestant has left{% endtrans %}</button>
          {% else %}
          <p>{{ p.leave_time|format_datetime_smart }}</p>
          <button type="submit" name="state" value="returned" class="btn">{% trans %}Contestant has returned{% endtrans %}</button>
          {% endif %}
        </form>
      </td>
      {% endif %}
      {% if allow_impersonate %}
      <td style="white-space: nowrap"><a href="{{ url("impersonate", p.id) }}" class="btn" target="_blank">{% trans %}Log in as contestant{% endtrans %}</a></td>
      {% endif %}
    </tr>
    {% endfor %}
  </tbody>
</table>

</div>
{% endblock core %}
